# Compose
COMPOSE_PROJECT_NAME=microinfra

# Node 环境
NODE_ENV=development

# 应用端口（生产环境）
API_PORT=3000
CRAWLER_PORT=3001
CLEANER_PORT=3002
WEB_PORT=8080
ADMIN_PORT=8081

# 应用端口（开发环境）
WEB_DEV_PORT=4200
ADMIN_DEV_PORT=4201

# PostgreSQL (基础设施配置)
POSTGRES_USER=app_user
POSTGRES_PASSWORD=change_me_please
POSTGRES_DB=app_db
POSTGRES_PORT=5432
POSTGRES_HEALTHCHECK_INTERVAL=10s
POSTGRES_HEALTHCHECK_TIMEOUT=5s
POSTGRES_HEALTHCHECK_RETRIES=5

# PostgreSQL (应用连接配置)
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_NAME=pro
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres123
DATABASE_URL=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}

# Redis (基础设施配置)
REDIS_PASSWORD=change_me_please
REDIS_PORT=6379
REDIS_HEALTHCHECK_INTERVAL=10s
REDIS_HEALTHCHECK_TIMEOUT=5s
REDIS_HEALTHCHECK_RETRIES=5

# Redis (应用连接配置)
REDIS_HOST=redis
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}

# RabbitMQ (基础设施配置)
RABBITMQ_DEFAULT_USER=app_user
RABBITMQ_DEFAULT_PASS=change_me_please
RABBITMQ_AMQP_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_HEALTHCHECK_INTERVAL=10s
RABBITMQ_HEALTHCHECK_TIMEOUT=5s
RABBITMQ_HEALTHCHECK_RETRIES=5

# RabbitMQ (应用连接配置)
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=rabbitmq
RABBITMQ_PASSWORD=rabbitmq123
RABBITMQ_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}

# MongoDB (基础设施配置)
MONGO_INITDB_ROOT_USERNAME=admin
MONGO_INITDB_ROOT_PASSWORD=change_me_please
MONGO_PORT=27017
MONGO_HEALTHCHECK_INTERVAL=10s
MONGO_HEALTHCHECK_TIMEOUT=5s
MONGO_HEALTHCHECK_RETRIES=5

# MongoDB (应用连接配置)
MONGODB_HOST=mongo
MONGODB_PORT=27017
MONGODB_DATABASE=pro
MONGODB_USER=mongo
MONGODB_PASSWORD=mongo123
MONGODB_URL=mongodb://${MONGODB_USER}:${MONGODB_PASSWORD}@${MONGODB_HOST}:${MONGODB_PORT}/${MONGODB_DATABASE}?authSource=admin

# MinIO (基础设施配置)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=change_me_please
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_BUCKET_NAME=app-bucket
MINIO_REGION=us-east-1
MINIO_HEALTHCHECK_INTERVAL=10s
MINIO_HEALTHCHECK_TIMEOUT=5s
MINIO_HEALTHCHECK_RETRIES=5

# MinIO (应用连接配置)
MINIO_ENDPOINT=minio
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_USE_SSL=false
MINIO_BUCKET=pro-storage

# Nginx
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
NGINX_PROXY_TIMEOUT=60s
NGINX_HEALTHCHECK_INTERVAL=10s
NGINX_HEALTHCHECK_TIMEOUT=5s
NGINX_HEALTHCHECK_RETRIES=5

# API 配置
API_URL=http://api:3000

# JWT 配置
JWT_SECRET=your-jwt-secret-change-in-production
JWT_EXPIRES_IN=7d

# WebSocket 连接防护
WS_HANDSHAKE_WINDOW_MS=10000
WS_MAX_HANDSHAKES_PER_IP=20
WS_HANDSHAKE_COOLDOWN_MS=15000
WS_FAILURE_WINDOW_MS=60000
WS_MAX_FAILURES_PER_IP=5
WS_FAILURE_COOLDOWN_MS=120000
WS_MAX_CONNECTIONS_PER_USER=8
WS_MAX_CONNECTIONS_PER_IP=12

# PubSub 配置
PUBSUB_DRIVER=redis
PUBSUB_NAMESPACE=@pro/api
PUBSUB_REDIS_MODE=standalone
PUBSUB_REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}
# 当启用集群模式时，取消注释以下配置并提供节点列表
# PUBSUB_REDIS_CLUSTER_NODES=redis-cluster-0.redis:6379,redis-cluster-1.redis:6379
# PUBSUB_REDIS_PASSWORD=${REDIS_PASSWORD}
# PUBSUB_REDIS_TLS=false
