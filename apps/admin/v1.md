# èˆ†æƒ…ç®¡ç†åå°ç³»ç»Ÿ V1 ç‰ˆæœ¬è§„åˆ’

## æ¦‚è¿°
èˆ†æƒ…ç®¡ç†åå°ç³»ç»Ÿï¼Œç”¨äºç®¡ç†çˆ¬è™«ä»»åŠ¡ã€æ•°æ®æºé…ç½®ã€é¢„è­¦è§„åˆ™ã€æƒ…æ„Ÿåˆ†æé…ç½®ã€æ•°æ®æŸ¥çœ‹ç­‰æ ¸å¿ƒç®¡ç†åŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆï¼ˆå·²ç¡®è®¤ï¼‰âœ…
- å‰ç«¯æ¡†æ¶: Angular 17+ + TypeScript
- çŠ¶æ€ç®¡ç†: RxJS + Angular Services
- UI ç»„ä»¶åº“: NG-ZORRO (Ant Design for Angular)
- è¡¨æ ¼ç»„ä»¶: nz-table (NG-ZORRO å†…ç½®)
- è¡¨å•ç»„ä»¶: nz-form (NG-ZORRO å†…ç½®)
- æ„å»ºå·¥å…·: Angular CLI
- æ•°æ®è¯·æ±‚: HttpClient (Angular å†…ç½®)
- CSS æ–¹æ¡ˆ: SCSS + NG-ZORRO æ ·å¼
- è·¯ç”±: @angular/router

## éœ€æ±‚ç¡®è®¤ âœ…
1. âœ… ä¸éœ€è¦å¤šç®¡ç†å‘˜è´¦å·/è§’è‰²æƒé™ï¼ˆç¬¬ä¸€æœŸå•ç”¨æˆ·å³å¯ï¼‰
2. âœ… ä¸éœ€è¦æ“ä½œæ—¥å¿—è®°å½•
3. âœ… ä¸éœ€è¦å›½é™…åŒ–æ”¯æŒ
4. âœ… ä¸éœ€è¦å“åº”å¼å¸ƒå±€ï¼ˆä»…PCç«¯ä½¿ç”¨ï¼‰
5. âœ… ä½¿ç”¨ NG-ZORRO ç»„ä»¶åº“
6. âœ… é‰´æƒæ–¹æ¡ˆï¼šç”¨æˆ·è¡¨ + å¯†ç åŠ å¯†ï¼ˆbcryptï¼‰
7. âœ… é¡µé¢å¸ƒå±€ï¼šå·¦ä¾§å¯¼èˆª + é¡¶éƒ¨æ  + å†…å®¹åŒº

## ç¬¬ä¸€æœŸæ ¸å¿ƒç›®æ ‡ ğŸ¯
**æœ€é‡è¦çš„åŠŸèƒ½ï¼šå¾®åšæ‰«ç ç™»å½•è·å– Cookie**

ç¬¬ä¸€æœŸä¸“æ³¨äºå®ç°å¾®åšæ‰«ç ç™»å½•åŠŸèƒ½ï¼Œè·å–å¹¶ä¿å­˜æœ‰æ•ˆçš„ Cookieï¼Œä¸ºåç»­çˆ¬è™«ä»»åŠ¡æä¾›ç™»å½•æ€ã€‚

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. å¾®åš Cookie ç®¡ç†ï¼ˆç¬¬ä¸€æœŸæ ¸å¿ƒåŠŸèƒ½ï¼‰ğŸ¯
- å¾®åšæ‰«ç ç™»å½•
- å®æ—¶æ˜¾ç¤ºäºŒç»´ç ï¼ˆä½¿ç”¨ Playwright ç”Ÿæˆï¼‰
- æ‰«ç çŠ¶æ€ç›‘æ§ï¼ˆæœªæ‰«ç /å·²æ‰«ç /å·²ç¡®è®¤/å·²è¿‡æœŸï¼‰
- Cookie è‡ªåŠ¨æå–å’Œä¿å­˜
- Cookie æœ‰æ•ˆæ€§éªŒè¯
- Cookie å¤±æ•ˆæé†’
- é‡æ–°è·å– Cookie åŠŸèƒ½
- Cookie ä¿¡æ¯å±•ç¤ºï¼ˆç™»å½•è´¦å·ã€è¿‡æœŸæ—¶é—´ç­‰ï¼‰

### 2. çˆ¬è™«ä»»åŠ¡ç®¡ç†
- ä»»åŠ¡åˆ—è¡¨å±•ç¤º
- åˆ›å»ºçˆ¬è™«ä»»åŠ¡ï¼ˆURLã€å…³é”®è¯ã€æ‰¹é‡ä»»åŠ¡ï¼‰
- ç¼–è¾‘ä»»åŠ¡é…ç½®
- å¯åŠ¨/åœæ­¢ä»»åŠ¡
- åˆ é™¤ä»»åŠ¡
- ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€å®æ—¶ç›‘æ§
- ä»»åŠ¡æ‰§è¡Œå†å²è®°å½•
- ä»»åŠ¡å¤±è´¥é‡è¯•

### 3. æ•°æ®æºé…ç½®
- çˆ¬è™«é¢‘ç‡é…ç½®
- User-Agent é…ç½®
- ä»£ç†æ± é…ç½®ï¼ˆå¯é€‰ï¼‰
- è¯·æ±‚è¶…æ—¶é…ç½®
- é‡è¯•æ¬¡æ•°é…ç½®

### 4. èˆ†æƒ…æ•°æ®ç®¡ç†
- èˆ†æƒ…æ•°æ®åˆ—è¡¨ï¼ˆåˆ†é¡µã€ç­›é€‰ã€æœç´¢ï¼‰
- æ•°æ®è¯¦æƒ…æŸ¥çœ‹
- æ•°æ®ç¼–è¾‘ï¼ˆæ ‡é¢˜ã€å†…å®¹ã€æƒ…æ„Ÿæ ‡ç­¾ç­‰ï¼‰
- æ•°æ®åˆ é™¤ï¼ˆæ”¯æŒæ‰¹é‡åˆ é™¤ï¼‰
- æ•°æ®å¯¼å‡ºï¼ˆExcelï¼‰
- æ•°æ®ç»Ÿè®¡å›¾è¡¨

### 5. é¢„è­¦è§„åˆ™é…ç½®
- é¢„è­¦è§„åˆ™åˆ—è¡¨
- åˆ›å»ºé¢„è­¦è§„åˆ™ï¼ˆå…³é”®è¯ã€æƒ…æ„Ÿã€çƒ­åº¦é˜ˆå€¼ç­‰ï¼‰
- ç¼–è¾‘é¢„è­¦è§„åˆ™
- å¯ç”¨/ç¦ç”¨è§„åˆ™
- åˆ é™¤è§„åˆ™
- é¢„è­¦å†å²è®°å½•
- é¢„è­¦æµ‹è¯•åŠŸèƒ½

### 6. æƒ…æ„Ÿåˆ†æé…ç½®
- å½“å‰æ¨¡å‹æ˜¾ç¤ºï¼ˆDeepSeek/OpenAI/é€šä¹‰åƒé—®ç­‰ï¼‰
- åˆ‡æ¢å¤§æ¨¡å‹ Provider
- API Key ç®¡ç†
- æ‰¹é‡åˆ†æé…ç½®ï¼ˆå¹¶å‘æ•°ã€è¶…æ—¶æ—¶é—´ï¼‰
- åˆ†ææ•ˆæœæµ‹è¯•
- åˆ†ææˆæœ¬ç»Ÿè®¡

### 7. æ•°æ®æ¸…æ´—è§„åˆ™
- å»é‡è§„åˆ™é…ç½®
- åƒåœ¾å†…å®¹è¿‡æ»¤è§„åˆ™ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰
- æ—¶é—´æ ¼å¼æ ‡å‡†åŒ–è§„åˆ™
- åœ°ç†ä½ç½®æå–è§„åˆ™
- è§„åˆ™æµ‹è¯•åŠŸèƒ½

### 8. ç³»ç»Ÿç›‘æ§
- çˆ¬è™«è¿è¡ŒçŠ¶æ€ï¼ˆå®æ—¶ï¼‰
- æ•°æ®å¤„ç†è¿›åº¦
- æ¶ˆæ¯é˜Ÿåˆ—çŠ¶æ€ï¼ˆRabbitMQï¼‰
- æ•°æ®åº“çŠ¶æ€
- Redis ç¼“å­˜ç»Ÿè®¡
- API è°ƒç”¨ç»Ÿè®¡
- é”™è¯¯æ—¥å¿—æŸ¥çœ‹

### 9. é¡µé¢é…ç½®ç®¡ç†ï¼ˆå¤ç”¨ web åŠŸèƒ½ï¼‰
- å¤§å±é¡µé¢åˆ—è¡¨
- é¡µé¢åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
- é¡µé¢é¢„è§ˆï¼ˆè·³è½¬åˆ° web åº”ç”¨ï¼‰

## é¡µé¢ç»“æ„

### ä¸»å¸ƒå±€ï¼ˆLayoutï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¡¶éƒ¨æ  (Header)                             â”‚
â”‚  - Logo + ç³»ç»Ÿåç§°                           â”‚
â”‚  - å½“å‰æ—¶é—´                                  â”‚
â”‚  - é€€å‡ºç™»å½•                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                  â”‚
â”‚  ä¾§è¾¹æ   â”‚         å†…å®¹åŒºåŸŸ                  â”‚
â”‚  (Sider) â”‚         (Content)                â”‚
â”‚          â”‚                                  â”‚
â”‚  - å¯¼èˆª  â”‚  - é¢åŒ…å±‘å¯¼èˆª                     â”‚
â”‚    èœå•  â”‚  - é¡µé¢å†…å®¹                       â”‚
â”‚          â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯¼èˆªèœå•ç»“æ„
```
ğŸ“Š ç³»ç»Ÿç›‘æ§ (Dashboard)
ğŸ” å¾®åš Cookie ç®¡ç† **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘**
ğŸ•·ï¸ çˆ¬è™«ç®¡ç†
   â”œâ”€ ä»»åŠ¡åˆ—è¡¨
   â””â”€ æ•°æ®æºé…ç½®
ğŸ“° æ•°æ®ç®¡ç†
   â”œâ”€ èˆ†æƒ…æ•°æ®
   â””â”€ é¢„è­¦è®°å½•
âš™ï¸ ç³»ç»Ÿé…ç½®
   â”œâ”€ æƒ…æ„Ÿåˆ†æé…ç½®
   â”œâ”€ æ•°æ®æ¸…æ´—è§„åˆ™
   â””â”€ é¢„è­¦è§„åˆ™é…ç½®
ğŸ–¥ï¸ å¤§å±ç®¡ç†
   â””â”€ é¡µé¢ç®¡ç†
```

## ç»„ä»¶æ‹†åˆ†

### 1. å¸ƒå±€ç»„ä»¶ (Layout Components)

#### 1.1 AdminLayout (ç®¡ç†åå°ä¸»å¸ƒå±€)
- åŠŸèƒ½: æ•´ä½“å¸ƒå±€æ¡†æ¶ï¼ˆé¡¶éƒ¨+ä¾§è¾¹+å†…å®¹ï¼‰
- ä½¿ç”¨: nz-layout

#### 1.2 AdminHeader (é¡¶éƒ¨æ )
- Logo + ç³»ç»Ÿåç§°
- å½“å‰æ—¶é—´
- é€€å‡ºç™»å½•æŒ‰é’®

#### 1.3 AdminSider (ä¾§è¾¹æ )
- å¯¼èˆªèœå• (nz-menu)
- èœå•æŠ˜å /å±•å¼€

### 2. å¾®åš Cookie ç®¡ç†ç»„ä»¶ **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘**

#### 2.0 WeiboCookieManager (å¾®åš Cookie ç®¡ç†é¡µé¢) ğŸ¯
- æ‰«ç ç™»å½•åŒºåŸŸ
  - äºŒç»´ç å±•ç¤º (nz-spin åŠ è½½çŠ¶æ€)
  - æ‰«ç çŠ¶æ€æç¤º
  - åˆ·æ–°äºŒç»´ç æŒ‰é’®
  - å€’è®¡æ—¶æ˜¾ç¤ºï¼ˆäºŒç»´ç æœ‰æ•ˆæœŸï¼‰
- Cookie ä¿¡æ¯å±•ç¤ºåŒºåŸŸ
  - å½“å‰ Cookie çŠ¶æ€ï¼ˆæœ‰æ•ˆ/å¤±æ•ˆï¼‰
  - ç™»å½•è´¦å·ä¿¡æ¯
  - Cookie åˆ›å»ºæ—¶é—´
  - Cookie è¿‡æœŸæ—¶é—´
  - Cookie è¯¦ç»†ä¿¡æ¯ï¼ˆå¯æŠ˜å ï¼‰
- æ“ä½œæŒ‰é’®
  - é‡æ–°è·å– Cookie
  - éªŒè¯ Cookie æœ‰æ•ˆæ€§
  - åˆ é™¤ Cookie
  - æŸ¥çœ‹ Cookie è¯¦æƒ…

### 3. çˆ¬è™«ç®¡ç†ç»„ä»¶

#### 3.1 CrawlerTaskList (ä»»åŠ¡åˆ—è¡¨)
- ä»»åŠ¡è¡¨æ ¼ (nz-table)
- çŠ¶æ€ç­›é€‰
- æœç´¢åŠŸèƒ½
- æ‰¹é‡æ“ä½œ

#### 3.2 CrawlerTaskForm (ä»»åŠ¡è¡¨å•)
- åˆ›å»º/ç¼–è¾‘ä»»åŠ¡è¡¨å• (nz-form)
- ä»»åŠ¡ç±»å‹é€‰æ‹© (URL/å…³é”®è¯/æ‰¹é‡)
- é…ç½®é€‰é¡¹

#### 3.3 CrawlerTaskDetail (ä»»åŠ¡è¯¦æƒ…)
- ä»»åŠ¡åŸºæœ¬ä¿¡æ¯
- æ‰§è¡Œå†å²
- é”™è¯¯æ—¥å¿—
- æ“ä½œæŒ‰é’®ï¼ˆå¯åŠ¨/åœæ­¢/é‡è¯•ï¼‰

#### 3.4 DataSourceConfig (æ•°æ®æºé…ç½®)
- å¾®åšé…ç½®è¡¨å•
- Cookie ç®¡ç†
- æµ‹è¯•è¿æ¥æŒ‰é’®

### 4. æ•°æ®ç®¡ç†ç»„ä»¶

#### 4.1 SentimentDataList (èˆ†æƒ…æ•°æ®åˆ—è¡¨)
- æ•°æ®è¡¨æ ¼ (nz-table + åˆ†é¡µ)
- é«˜çº§ç­›é€‰ (nz-form)
- æ‰¹é‡æ“ä½œ
- å¯¼å‡ºåŠŸèƒ½

#### 4.2 SentimentDataDetail (æ•°æ®è¯¦æƒ…)
- è¯¦æƒ…æŠ½å±‰ (nz-drawer)
- æ•°æ®ç¼–è¾‘è¡¨å•
- åˆ é™¤ç¡®è®¤

#### 4.3 AlertRecordList (é¢„è­¦è®°å½•åˆ—è¡¨)
- é¢„è­¦è®°å½•è¡¨æ ¼
- çŠ¶æ€ç­›é€‰
- æŸ¥çœ‹è¯¦æƒ…

### 5. ç³»ç»Ÿé…ç½®ç»„ä»¶

#### 5.1 SentimentAnalysisConfig (æƒ…æ„Ÿåˆ†æé…ç½®)
- Provider é€‰æ‹© (nz-radio-group)
- API Key é…ç½®
- å‚æ•°è°ƒæ•´
- æµ‹è¯•åŠŸèƒ½

#### 5.2 CleaningRuleList (æ¸…æ´—è§„åˆ™åˆ—è¡¨)
- è§„åˆ™åˆ—è¡¨è¡¨æ ¼
- è§„åˆ™å¯ç”¨/ç¦ç”¨å¼€å…³
- è§„åˆ™æµ‹è¯•

#### 5.3 CleaningRuleForm (æ¸…æ´—è§„åˆ™è¡¨å•)
- è§„åˆ™åç§°
- è§„åˆ™ç±»å‹
- æ­£åˆ™è¡¨è¾¾å¼
- ä¼˜å…ˆçº§

#### 5.4 AlertRuleList (é¢„è­¦è§„åˆ™åˆ—è¡¨)
- è§„åˆ™è¡¨æ ¼
- è§„åˆ™çŠ¶æ€
- è§„åˆ™æµ‹è¯•

#### 5.5 AlertRuleForm (é¢„è­¦è§„åˆ™è¡¨å•)
- è§„åˆ™åç§°
- å…³é”®è¯é…ç½®
- è§¦å‘æ¡ä»¶
- é€šçŸ¥æ–¹å¼

### 6. ç³»ç»Ÿç›‘æ§ç»„ä»¶

#### 6.1 SystemDashboard (ç³»ç»Ÿç›‘æ§é¢æ¿)
- ç»Ÿè®¡å¡ç‰‡ (nz-card)
- çŠ¶æ€æŒ‡ç¤ºå™¨
- å®æ—¶æ•°æ®å›¾è¡¨ (ngx-echarts)
- å¿«æ·æ“ä½œ

#### 6.2 CrawlerStatusPanel (çˆ¬è™«çŠ¶æ€é¢æ¿)
- è¿è¡Œä¸­çš„ä»»åŠ¡
- ä»»åŠ¡é˜Ÿåˆ—çŠ¶æ€
- é”™è¯¯ç»Ÿè®¡

#### 6.3 DataProcessingPanel (æ•°æ®å¤„ç†é¢æ¿)
- å¤„ç†è¿›åº¦
- æˆåŠŸ/å¤±è´¥ç»Ÿè®¡
- å¤„ç†é€Ÿç‡

#### 6.4 SystemStatusPanel (ç³»ç»ŸçŠ¶æ€é¢æ¿)
- æ•°æ®åº“çŠ¶æ€
- Redis çŠ¶æ€
- RabbitMQ çŠ¶æ€
- é”™è¯¯æ—¥å¿—

### 7. å¤§å±ç®¡ç†ç»„ä»¶

#### 7.1 ScreenPageList (é¡µé¢åˆ—è¡¨)
- é¡µé¢è¡¨æ ¼
- é¢„è§ˆæŒ‰é’®
- ç¼–è¾‘/åˆ é™¤æŒ‰é’®

### 8. å…¬å…±ç»„ä»¶

#### 8.1 SearchForm (æœç´¢è¡¨å•)
- é€šç”¨æœç´¢ç»„ä»¶
- æ”¯æŒå¤šç§ç­›é€‰æ¡ä»¶

#### 8.2 ConfirmModal (ç¡®è®¤å¯¹è¯æ¡†)
- ç»Ÿä¸€çš„ç¡®è®¤å¼¹çª—

#### 8.3 StatusBadge (çŠ¶æ€æ ‡ç­¾)
- ä»»åŠ¡çŠ¶æ€æ˜¾ç¤º
- æ•°æ®å¤„ç†çŠ¶æ€æ˜¾ç¤º

## é¡¹ç›®ç»“æ„ (Angular)
```
apps/admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ services/           # æ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts      # ç®€å•é‰´æƒ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ api.service.ts       # API å°è£…
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ notification.service.ts  # é€šçŸ¥æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ interceptors/       # æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.interceptor.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ error.interceptor.ts
â”‚   â”‚   â”‚   â””â”€â”€ guards/             # è·¯ç”±å®ˆå«
â”‚   â”‚   â”‚       â””â”€â”€ auth.guard.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ shared/                 # å…±äº«æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ components/        # å…±äº«ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ search-form/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ confirm-modal/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ status-badge/
â”‚   â”‚   â”‚   â”œâ”€â”€ pipes/             # ç®¡é“
â”‚   â”‚   â”‚   â””â”€â”€ directives/        # æŒ‡ä»¤
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ layout/                # å¸ƒå±€æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ admin-layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ admin-header/
â”‚   â”‚   â”‚   â””â”€â”€ admin-sider/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pages/                 # é¡µé¢æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ login/            # ç™»å½•é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/        # ç³»ç»Ÿç›‘æ§
â”‚   â”‚   â”‚   â”œâ”€â”€ weibo-cookie/    # å¾®åš Cookie ç®¡ç† **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘**
â”‚   â”‚   â”‚   â”œâ”€â”€ crawler/          # çˆ¬è™«ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task-list/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task-detail/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ data-source/
â”‚   â”‚   â”‚   â”œâ”€â”€ data/             # æ•°æ®ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sentiment-list/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ alert-record/
â”‚   â”‚   â”‚   â”œâ”€â”€ config/           # ç³»ç»Ÿé…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sentiment-analysis/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ cleaning-rule/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ alert-rule/
â”‚   â”‚   â”‚   â””â”€â”€ screen/           # å¤§å±ç®¡ç†
â”‚   â”‚   â”‚       â””â”€â”€ page-list/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ crawler.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ sentiment.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ alert.model.ts
â”‚   â”‚   â”‚   â””â”€â”€ config.model.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ app.component.ts
â”‚   â”‚   â”œâ”€â”€ app.config.ts
â”‚   â”‚   â””â”€â”€ app.routes.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ assets/                   # é™æ€èµ„æº
â”‚   â”œâ”€â”€ styles/                   # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ styles.scss          # ä¸»æ ·å¼æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ variables.scss       # SCSS å˜é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ environments/            # ç¯å¢ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ environment.ts
â”‚   â”‚   â””â”€â”€ environment.prod.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ main.ts
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ angular.json
â””â”€â”€ tsconfig.json
```

## è·¯ç”±ç»“æ„
```typescript
const routes: Routes = [
  {
    path: 'login',
    component: LoginComponent
  },
  {
    path: '',
    component: AdminLayoutComponent,
    canActivate: [AuthGuard],
    children: [
      {
        path: 'dashboard',
        component: DashboardComponent
      },
      {
        path: 'weibo-cookie',
        component: WeiboCookieManagerComponent  // **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘**
      },
      {
        path: 'crawler',
        children: [
          { path: 'tasks', component: CrawlerTaskListComponent },
          { path: 'tasks/:id', component: CrawlerTaskDetailComponent },
          { path: 'data-source', component: DataSourceConfigComponent }
        ]
      },
      {
        path: 'data',
        children: [
          { path: 'sentiment', component: SentimentDataListComponent },
          { path: 'alert', component: AlertRecordListComponent }
        ]
      },
      {
        path: 'config',
        children: [
          { path: 'sentiment-analysis', component: SentimentAnalysisConfigComponent },
          { path: 'cleaning-rule', component: CleaningRuleListComponent },
          { path: 'alert-rule', component: AlertRuleListComponent }
        ]
      },
      {
        path: 'screen',
        children: [
          { path: 'pages', component: ScreenPageListComponent }
        ]
      },
      {
        path: '',
        redirectTo: 'dashboard',
        pathMatch: 'full'
      }
    ]
  }
];
```

## åç«¯ API éœ€æ±‚ï¼ˆéœ€è¦ apps/api æ”¯æŒï¼‰

### 0. ç”¨æˆ·é‰´æƒ API **ã€æ–°å¢ã€‘**

#### ç”¨æˆ·è¡¨è®¾è®¡
```sql
CREATE TABLE admin_users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  username VARCHAR(50) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,    -- bcrypt åŠ å¯†åçš„å¯†ç 
  email VARCHAR(100),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  last_login_at TIMESTAMP
);

-- åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜ï¼ˆå¯†ç : admin123ï¼‰
INSERT INTO admin_users (username, password_hash)
VALUES ('admin', '$2b$10$...');  -- bcrypt hash of 'admin123'
```

#### é‰´æƒæ¥å£
```typescript
// ç™»å½•
POST /api/admin/auth/login
Body: { username: string, password: string }
Response: {
  success: boolean,
  token: string,        // JWT token
  user: {
    id: string,
    username: string,
    email: string
  }
}

// éªŒè¯ Token
GET /api/admin/auth/verify
Headers: { Authorization: 'Bearer <token>' }
Response: {
  valid: boolean,
  user: {
    id: string,
    username: string
  }
}

// ä¿®æ”¹å¯†ç 
POST /api/admin/auth/change-password
Headers: { Authorization: 'Bearer <token>' }
Body: { oldPassword: string, newPassword: string }
Response: { success: boolean }

// ç™»å‡ºï¼ˆå¯é€‰ï¼Œå‰ç«¯åˆ é™¤ token å³å¯ï¼‰
POST /api/admin/auth/logout
Headers: { Authorization: 'Bearer <token>' }
Response: { success: boolean }
```

### 1. å¾®åš Cookie ç®¡ç† API **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘**ğŸ¯

#### Cookie æ•°æ®è¡¨è®¾è®¡
```sql
CREATE TABLE weibo_cookies (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  cookies TEXT NOT NULL,                  -- JSON æ ¼å¼å­˜å‚¨ Cookie æ•°ç»„
  user_info JSONB,                        -- å¾®åšç”¨æˆ·ä¿¡æ¯ï¼ˆæ˜µç§°ã€UIDç­‰ï¼‰
  status VARCHAR(20) DEFAULT 'active',    -- active | expired | invalid
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  expires_at TIMESTAMP,                   -- Cookie é¢„è®¡è¿‡æœŸæ—¶é—´
  last_validated_at TIMESTAMP             -- æœ€åéªŒè¯æ—¶é—´
);
```

#### Cookie ç®¡ç†æ¥å£
```typescript
// å¯åŠ¨å¾®åšæ‰«ç ç™»å½•ï¼ˆç”ŸæˆäºŒç»´ç ï¼‰
POST /api/admin/weibo/cookie/start-login
Response: {
  sessionId: string,        // ç™»å½•ä¼šè¯ID
  qrCodeUrl: string,        // äºŒç»´ç å›¾ç‰‡ URLï¼ˆbase64 æˆ–å›¾ç‰‡é“¾æ¥ï¼‰
  expiresIn: number,        // äºŒç»´ç æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
  status: 'pending'         // pending | scanned | confirmed | expired
}

// è½®è¯¢æ‰«ç çŠ¶æ€
GET /api/admin/weibo/cookie/login-status/:sessionId
Response: {
  status: 'pending' | 'scanned' | 'confirmed' | 'expired' | 'failed',
  message?: string,
  cookieId?: string         // ç™»å½•æˆåŠŸåè¿”å› Cookie ID
}

// è·å–å½“å‰ Cookie ä¿¡æ¯
GET /api/admin/weibo/cookie/current
Response: {
  id: string,
  userInfo: {
    nickname: string,
    uid: string,
    avatarUrl?: string
  },
  status: 'active' | 'expired' | 'invalid',
  createdAt: string,
  expiresAt: string,
  lastValidatedAt: string
}

// éªŒè¯ Cookie æœ‰æ•ˆæ€§
POST /api/admin/weibo/cookie/validate
Response: {
  valid: boolean,
  message: string,
  userInfo?: any
}

// åˆ é™¤ Cookie
DELETE /api/admin/weibo/cookie/:id
Response: { success: boolean }

// è·å– Cookie è¯¦æƒ…
GET /api/admin/weibo/cookie/:id
Response: {
  id: string,
  cookies: Cookie[],        // Cookie æ•°ç»„
  userInfo: any,
  status: string,
  createdAt: string,
  expiresAt: string
}
```

#### Cookie è·å–æµç¨‹è¯´æ˜
```
å‰ç«¯è°ƒç”¨ start-login
  â†“
åç«¯ä½¿ç”¨ Playwright å¯åŠ¨æµè§ˆå™¨ï¼Œæ‰“å¼€å¾®åšç™»å½•é¡µ
  â†“
åç«¯ç”ŸæˆäºŒç»´ç å¹¶è¿”å›ç»™å‰ç«¯ï¼ˆbase64 å›¾ç‰‡ï¼‰
  â†“
å‰ç«¯è½®è¯¢ login-status æ¥å£ï¼ˆæ¯ 2 ç§’ï¼‰
  â†“
ç”¨æˆ·æ‰«ç  â†’ åç«¯æ£€æµ‹åˆ°ç™»å½•æˆåŠŸ
  â†“
åç«¯æå– Cookie å¹¶ä¿å­˜åˆ°æ•°æ®åº“
  â†“
è¿”å› status: 'confirmed' å’Œ cookieId
  â†“
å‰ç«¯æ˜¾ç¤ºç™»å½•æˆåŠŸï¼Œå±•ç¤º Cookie ä¿¡æ¯
```

### 2. çˆ¬è™«ç®¡ç† API

#### ä»»åŠ¡ç®¡ç†
```typescript
// è·å–ä»»åŠ¡åˆ—è¡¨
GET /api/admin/crawler/tasks
Query: { page, pageSize, status?, keyword? }
Response: { total, items: CrawlTask[] }

// è·å–ä»»åŠ¡è¯¦æƒ…
GET /api/admin/crawler/tasks/:id
Response: CrawlTask

// åˆ›å»ºä»»åŠ¡
POST /api/admin/crawler/tasks
Body: { taskType, config }
Response: CrawlTask

// æ›´æ–°ä»»åŠ¡
PUT /api/admin/crawler/tasks/:id
Body: Partial<CrawlTask>
Response: CrawlTask

// åˆ é™¤ä»»åŠ¡
DELETE /api/admin/crawler/tasks/:id
Response: { success: boolean }

// å¯åŠ¨ä»»åŠ¡
POST /api/admin/crawler/tasks/:id/start
Response: { success: boolean }

// åœæ­¢ä»»åŠ¡
POST /api/admin/crawler/tasks/:id/stop
Response: { success: boolean }

// é‡è¯•ä»»åŠ¡
POST /api/admin/crawler/tasks/:id/retry
Response: { success: boolean }

// è·å–ä»»åŠ¡æ‰§è¡Œå†å²
GET /api/admin/crawler/tasks/:id/history
Query: { page, pageSize }
Response: { total, items: TaskHistory[] }
```

#### æ•°æ®æºé…ç½®
```typescript
// è·å–æ•°æ®æºé…ç½®
GET /api/admin/crawler/data-source
Response: DataSourceConfig

// æ›´æ–°æ•°æ®æºé…ç½®
PUT /api/admin/crawler/data-source
Body: DataSourceConfig
Response: DataSourceConfig

// æµ‹è¯•æ•°æ®æºè¿æ¥
POST /api/admin/crawler/data-source/test
Response: { success: boolean, message: string }
```

### 3. æ•°æ®ç®¡ç† API

#### èˆ†æƒ…æ•°æ®
```typescript
// è·å–èˆ†æƒ…æ•°æ®åˆ—è¡¨
GET /api/admin/data/sentiment
Query: { page, pageSize, sentiment?, source?, keyword?, startTime?, endTime? }
Response: { total, items: SentimentNews[] }

// è·å–å•æ¡æ•°æ®
GET /api/admin/data/sentiment/:id
Response: SentimentNews

// æ›´æ–°æ•°æ®
PUT /api/admin/data/sentiment/:id
Body: Partial<SentimentNews>
Response: SentimentNews

// åˆ é™¤æ•°æ®
DELETE /api/admin/data/sentiment/:id
Response: { success: boolean }

// æ‰¹é‡åˆ é™¤
POST /api/admin/data/sentiment/batch-delete
Body: { ids: string[] }
Response: { success: boolean, deletedCount: number }

// å¯¼å‡ºæ•°æ®
POST /api/admin/data/sentiment/export
Body: { filters: any }
Response: { downloadUrl: string }
```

#### é¢„è­¦è®°å½•
```typescript
// è·å–é¢„è­¦è®°å½•
GET /api/admin/data/alerts
Query: { page, pageSize, severity?, isResolved? }
Response: { total, items: Alert[] }

// æ ‡è®°é¢„è­¦å·²è§£å†³
POST /api/admin/data/alerts/:id/resolve
Response: { success: boolean }
```

### 4. ç³»ç»Ÿé…ç½® API

#### æƒ…æ„Ÿåˆ†æé…ç½®
```typescript
// è·å–æƒ…æ„Ÿåˆ†æé…ç½®
GET /api/admin/config/sentiment-analysis
Response: SentimentAnalysisConfig

// æ›´æ–°é…ç½®
PUT /api/admin/config/sentiment-analysis
Body: SentimentAnalysisConfig
Response: SentimentAnalysisConfig

// åˆ‡æ¢ Provider
POST /api/admin/config/sentiment-analysis/provider
Body: { provider: string }
Response: { success: boolean }

// æµ‹è¯•æƒ…æ„Ÿåˆ†æ
POST /api/admin/config/sentiment-analysis/test
Body: { text: string }
Response: SentimentAnalysisResult
```

#### æ•°æ®æ¸…æ´—è§„åˆ™
```typescript
// è·å–æ¸…æ´—è§„åˆ™åˆ—è¡¨
GET /api/admin/config/cleaning-rules
Response: CleaningRule[]

// åˆ›å»ºè§„åˆ™
POST /api/admin/config/cleaning-rules
Body: CleaningRule
Response: CleaningRule

// æ›´æ–°è§„åˆ™
PUT /api/admin/config/cleaning-rules/:id
Body: Partial<CleaningRule>
Response: CleaningRule

// åˆ é™¤è§„åˆ™
DELETE /api/admin/config/cleaning-rules/:id
Response: { success: boolean }

// æµ‹è¯•è§„åˆ™
POST /api/admin/config/cleaning-rules/:id/test
Body: { testData: string }
Response: { result: string }
```

#### é¢„è­¦è§„åˆ™é…ç½®
```typescript
// è·å–é¢„è­¦è§„åˆ™åˆ—è¡¨
GET /api/admin/config/alert-rules
Response: AlertRule[]

// åˆ›å»ºè§„åˆ™
POST /api/admin/config/alert-rules
Body: AlertRule
Response: AlertRule

// æ›´æ–°è§„åˆ™
PUT /api/admin/config/alert-rules/:id
Body: Partial<AlertRule>
Response: AlertRule

// åˆ é™¤è§„åˆ™
DELETE /api/admin/config/alert-rules/:id
Response: { success: boolean }

// å¯ç”¨/ç¦ç”¨è§„åˆ™
POST /api/admin/config/alert-rules/:id/toggle
Body: { enabled: boolean }
Response: { success: boolean }

// æµ‹è¯•è§„åˆ™
POST /api/admin/config/alert-rules/:id/test
Body: { testData: any }
Response: { triggered: boolean, result: any }
```

### 5. ç³»ç»Ÿç›‘æ§ API

```typescript
// è·å–ç³»ç»ŸçŠ¶æ€
GET /api/admin/monitor/status
Response: {
  crawler: { running: number, pending: number, failed: number },
  dataProcessing: { total: number, processed: number, failed: number },
  system: {
    database: { status: string },
    redis: { status: string },
    rabbitmq: { status: string }
  }
}

// è·å–é”™è¯¯æ—¥å¿—
GET /api/admin/monitor/errors
Query: { page, pageSize, level? }
Response: { total, items: ErrorLog[] }

// è·å–æ•°æ®ç»Ÿè®¡
GET /api/admin/monitor/statistics
Response: {
  todayNewData: number,
  totalData: number,
  sentimentDistribution: any,
  sourceDistribution: any
}
```


## æ•°æ®æ¨¡å‹

### ç”¨æˆ·æ¨¡å‹ **ã€æ–°å¢ã€‘**
```typescript
export interface AdminUser {
  id: string;
  username: string;
  email?: string;
  createdAt: Date;
  updatedAt: Date;
  lastLoginAt?: Date;
}

export interface LoginRequest {
  username: string;
  password: string;
}

export interface LoginResponse {
  success: boolean;
  token: string;
  user: AdminUser;
}
```

### å¾®åš Cookie æ¨¡å‹ **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘**
```typescript
export interface WeiboCookie {
  id: string;
  cookies: Array<{
    name: string;
    value: string;
    domain: string;
    path: string;
    expires?: number;
    httpOnly?: boolean;
    secure?: boolean;
  }>;
  userInfo?: {
    nickname: string;
    uid: string;
    avatarUrl?: string;
  };
  status: 'active' | 'expired' | 'invalid';
  createdAt: Date;
  updatedAt: Date;
  expiresAt?: Date;
  lastValidatedAt?: Date;
}

export interface WeiboLoginSession {
  sessionId: string;
  qrCodeUrl: string;          // base64 å›¾ç‰‡æˆ–å›¾ç‰‡é“¾æ¥
  expiresIn: number;          // ç§’
  status: 'pending' | 'scanned' | 'confirmed' | 'expired' | 'failed';
}

export interface WeiboLoginStatus {
  status: 'pending' | 'scanned' | 'confirmed' | 'expired' | 'failed';
  message?: string;
  cookieId?: string;
}
```

### çˆ¬è™«ä»»åŠ¡æ¨¡å‹
```typescript
export interface CrawlTask {
  id: string;
  taskType: 'url' | 'keyword' | 'batch';
  status: 'pending' | 'running' | 'completed' | 'failed';
  priority: number;
  config: {
    urls?: string[];
    keywords?: string[];
    maxPages?: number;
    depth?: number;
    rateLimit?: number;
  };
  result?: {
    totalUrls: number;
    successCount: number;
    failedCount: number;
    startTime?: Date;
    endTime?: Date;
    duration?: number;
  };
  createdAt: Date;
  updatedAt: Date;
}

export interface TaskHistory {
  id: string;
  taskId: string;
  status: string;
  result: any;
  error?: string;
  startTime: Date;
  endTime?: Date;
}
```

### æ•°æ®æºé…ç½®æ¨¡å‹
```typescript
export interface DataSourceConfig {
  weibo: {
    enabled: boolean;
    cookies?: string;
    userAgent: string;
    requestDelay: number;
    maxRetries: number;
    useProxy: boolean;
  };
}
```

### æ¸…æ´—è§„åˆ™æ¨¡å‹
```typescript
export interface CleaningRule {
  id: string;
  name: string;
  type: 'deduplication' | 'filter' | 'format' | 'extract';
  enabled: boolean;
  priority: number;
  config: {
    regex?: string;
    replacement?: string;
    threshold?: number;
  };
  description?: string;
  createdAt: Date;
  updatedAt: Date;
}
```

### é¢„è­¦è§„åˆ™æ¨¡å‹
```typescript
export interface AlertRule {
  id: string;
  name: string;
  enabled: boolean;
  conditions: {
    keywords?: string[];
    sentiment?: 'positive' | 'neutral' | 'negative';
    hotValueThreshold?: number;
    sourceFilter?: string[];
  };
  actions: {
    notifyEmail?: boolean;
    notifyWebhook?: boolean;
    createAlert?: boolean;
  };
  createdAt: Date;
  updatedAt: Date;
}
```

## å¼€å‘è®¡åˆ’ï¼ˆä»»åŠ¡æ‹†åˆ†ä¸ä¾èµ–å…³ç³»ï¼‰

### ç¬¬ä¸€æœŸå¼€å‘è®¡åˆ’ ğŸ¯ï¼ˆå¾®åš Cookie ç®¡ç†ï¼‰

#### é˜¶æ®µ 1: é¡¹ç›®åˆå§‹åŒ–ï¼ˆæ— ä¾èµ–ï¼Œå¯å¹¶è¡Œï¼‰
- [ ] T1.1 æ£€æŸ¥ç°æœ‰ Angular é¡¹ç›®é…ç½®
- [ ] T1.2 å®‰è£… NG-ZORRO ä¾èµ–
- [ ] T1.3 é…ç½® NG-ZORRO æ¨¡å—
- [ ] T1.4 é…ç½® ESLint + Prettierï¼ˆå·²æœ‰åˆ™è·³è¿‡ï¼‰
- [ ] T1.5 åˆ›å»ºåŸºç¡€ç›®å½•ç»“æ„
- [ ] T1.6 é…ç½®ç¯å¢ƒå˜é‡æ–‡ä»¶
- [ ] T1.7 é…ç½®è·¯ç”±

**æäº¤ç‚¹**: å®ŒæˆåŸºç¡€é¡¹ç›®é…ç½®

#### é˜¶æ®µ 2: æ ¸å¿ƒæœåŠ¡æ­å»ºï¼ˆä¾èµ–é˜¶æ®µ1ï¼‰
- [ ] T2.1 åˆ›å»º API æœåŠ¡ï¼ˆHttpClient å°è£…ï¼‰
- [ ] T2.2 åˆ›å»ºé‰´æƒæœåŠ¡ï¼ˆAuthServiceï¼Œæ”¯æŒç”¨æˆ·åå¯†ç ç™»å½•ï¼‰
- [ ] T2.3 åˆ›å»ºé€šçŸ¥æœåŠ¡ï¼ˆNotificationServiceï¼‰
- [ ] T2.4 åˆ›å»º HTTP æ‹¦æˆªå™¨ï¼ˆJWT é‰´æƒã€é”™è¯¯å¤„ç†ï¼‰
- [ ] T2.5 åˆ›å»ºè·¯ç”±å®ˆå«ï¼ˆAuthGuardï¼‰
- [ ] T2.6 å®šä¹‰ TypeScript æ¨¡å‹ï¼ˆUser, WeiboCookie ç­‰ï¼‰

**æäº¤ç‚¹**: å®ŒæˆåŸºç¡€è®¾æ–½æ­å»º

#### é˜¶æ®µ 3: å¸ƒå±€å’Œç™»å½•ï¼ˆä¾èµ–é˜¶æ®µ2ï¼‰
- [ ] T3.1 å¼€å‘ AdminLayout ç»„ä»¶ï¼ˆå·¦ä¾§å¯¼èˆª+é¡¶éƒ¨æ +å†…å®¹åŒºï¼‰
- [ ] T3.2 å¼€å‘ AdminHeader ç»„ä»¶
- [ ] T3.3 å¼€å‘ AdminSider ç»„ä»¶ï¼ˆå¯¼èˆªèœå•ï¼‰
- [ ] T3.4 å¼€å‘ç™»å½•é¡µé¢ï¼ˆLoginComponentï¼Œç”¨æˆ·å+å¯†ç ï¼‰
- [ ] T3.5 å®ç°é‰´æƒé€»è¾‘ï¼ˆJWT Tokenï¼‰

**æäº¤ç‚¹**: å®Œæˆå¸ƒå±€æ¡†æ¶å’Œç™»å½•åŠŸèƒ½

#### é˜¶æ®µ 4: å¾®åš Cookie ç®¡ç†é¡µé¢ **ã€ç¬¬ä¸€æœŸæ ¸å¿ƒã€‘** ğŸ¯ï¼ˆä¾èµ–é˜¶æ®µ3ï¼‰
- [ ] T4.1 å¼€å‘ WeiboCookieManager ç»„ä»¶
- [ ] T4.2 å®ç°å¯åŠ¨æ‰«ç ç™»å½•åŠŸèƒ½
  - è°ƒç”¨åç«¯ start-login æ¥å£
  - æ˜¾ç¤ºäºŒç»´ç ï¼ˆbase64 å›¾ç‰‡ï¼‰
  - æ˜¾ç¤ºå€’è®¡æ—¶
- [ ] T4.3 å®ç°æ‰«ç çŠ¶æ€è½®è¯¢
  - æ¯ 2 ç§’è½®è¯¢ login-status æ¥å£
  - å®æ—¶æ›´æ–°çŠ¶æ€æç¤º
  - æ‰«ç æˆåŠŸååœæ­¢è½®è¯¢
- [ ] T4.4 å®ç° Cookie ä¿¡æ¯å±•ç¤º
  - æ˜¾ç¤ºç™»å½•è´¦å·ä¿¡æ¯
  - æ˜¾ç¤º Cookie çŠ¶æ€
  - æ˜¾ç¤ºåˆ›å»º/è¿‡æœŸæ—¶é—´
- [ ] T4.5 å®ç° Cookie æ“ä½œåŠŸèƒ½
  - éªŒè¯ Cookie æœ‰æ•ˆæ€§
  - é‡æ–°è·å– Cookie
  - åˆ é™¤ Cookie
  - æŸ¥çœ‹ Cookie è¯¦æƒ…ï¼ˆæŠ˜å é¢æ¿ï¼‰
- [ ] T4.6 å®ç°é”™è¯¯å¤„ç†å’Œæç¤º
- [ ] T4.7 å®ç°é¡µé¢æ ·å¼ä¼˜åŒ–

**æäº¤ç‚¹**: å®Œæˆå¾®åš Cookie ç®¡ç†åŠŸèƒ½ âœ…

#### é˜¶æ®µ 5: åç«¯ API å¼€å‘ **ã€å¹¶è¡Œå¼€å‘ã€‘** ğŸ¯ï¼ˆä¾èµ– apps/apiï¼‰
- [ ] T5.1 åˆ›å»º admin_users è¡¨å’Œé»˜è®¤ç®¡ç†å‘˜
- [ ] T5.2 å®ç°ç”¨æˆ·é‰´æƒ APIï¼ˆç™»å½•ã€éªŒè¯ã€ä¿®æ”¹å¯†ç ï¼‰
- [ ] T5.3 åˆ›å»º weibo_cookies è¡¨
- [ ] T5.4 å®ç°å¾®åšæ‰«ç ç™»å½•åŠŸèƒ½
  - ä½¿ç”¨ Playwright å¯åŠ¨æµè§ˆå™¨
  - ç”ŸæˆäºŒç»´ç ï¼ˆæˆªå›¾æˆ–æå–å›¾ç‰‡ï¼‰
  - ç›‘æ§ç™»å½•çŠ¶æ€
  - æå– Cookie
- [ ] T5.5 å®ç° Cookie ç®¡ç† API
  - Cookie ä¿å­˜åˆ°æ•°æ®åº“
  - Cookie éªŒè¯
  - Cookie æŸ¥è¯¢
  - Cookie åˆ é™¤
- [ ] T5.6 å®ç° WebSocket å®æ—¶æ¨é€ï¼ˆå¯é€‰ï¼Œç”¨äºæ¨é€æ‰«ç çŠ¶æ€ï¼‰

**æäº¤ç‚¹**: å®Œæˆåç«¯ Cookie ç®¡ç†åŠŸèƒ½ âœ…

### ç¬¬äºŒæœŸå¼€å‘è®¡åˆ’ï¼ˆå…¶ä»–åŠŸèƒ½ï¼‰

#### é˜¶æ®µ 6: ç³»ç»Ÿç›‘æ§é¡µé¢ï¼ˆä¾èµ–é˜¶æ®µ3ï¼‰
- [ ] T6.1 å¼€å‘ SystemDashboard ç»„ä»¶
- [ ] T6.2 å¼€å‘ CrawlerStatusPanel ç»„ä»¶
- [ ] T6.3 å¼€å‘ DataProcessingPanel ç»„ä»¶
- [ ] T6.4 å¼€å‘ SystemStatusPanel ç»„ä»¶
- [ ] T6.5 é›†æˆ ngx-echartsï¼ˆç»Ÿè®¡å›¾è¡¨ï¼‰
- [ ] T6.6 å®ç°æ•°æ®åˆ·æ–°åŠŸèƒ½

**æäº¤ç‚¹**: å®Œæˆç³»ç»Ÿç›‘æ§é¡µé¢

#### é˜¶æ®µ 7A: çˆ¬è™«ç®¡ç†æ¨¡å—ï¼ˆä¾èµ–é˜¶æ®µ3ï¼Œå¯å¹¶è¡Œï¼‰
- [ ] T7A.1 å¼€å‘ CrawlerTaskList ç»„ä»¶
- [ ] T7A.2 å¼€å‘ CrawlerTaskForm ç»„ä»¶
- [ ] T7A.3 å¼€å‘ CrawlerTaskDetail ç»„ä»¶
- [ ] T7A.4 å®ç°ä»»åŠ¡ CRUD åŠŸèƒ½
- [ ] T7A.5 å®ç°ä»»åŠ¡å¯åŠ¨/åœæ­¢åŠŸèƒ½
- [ ] T7A.6 å¼€å‘ DataSourceConfig ç»„ä»¶
- [ ] T7A.7 å®ç°æ•°æ®æºé…ç½®åŠŸèƒ½

**æäº¤ç‚¹**: å®Œæˆçˆ¬è™«ç®¡ç†æ¨¡å—

#### é˜¶æ®µ 7B: æ•°æ®ç®¡ç†æ¨¡å—ï¼ˆä¾èµ–é˜¶æ®µ3ï¼Œå¯å¹¶è¡Œï¼‰
- [ ] T7B.1 å¼€å‘ SentimentDataList ç»„ä»¶
- [ ] T7B.2 å¼€å‘ SentimentDataDetail ç»„ä»¶
- [ ] T7B.3 å®ç°æ•°æ®ç­›é€‰å’Œæœç´¢
- [ ] T7B.4 å®ç°æ•°æ®ç¼–è¾‘åŠŸèƒ½
- [ ] T7B.5 å®ç°æ‰¹é‡åˆ é™¤åŠŸèƒ½
- [ ] T7B.6 å®ç°æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] T7B.7 å¼€å‘ AlertRecordList ç»„ä»¶

**æäº¤ç‚¹**: å®Œæˆæ•°æ®ç®¡ç†æ¨¡å—

#### é˜¶æ®µ 7C: ç³»ç»Ÿé…ç½®æ¨¡å—ï¼ˆä¾èµ–é˜¶æ®µ3ï¼Œå¯å¹¶è¡Œï¼‰
- [ ] T7C.1 å¼€å‘ SentimentAnalysisConfig ç»„ä»¶
- [ ] T7C.2 å®ç° Provider åˆ‡æ¢åŠŸèƒ½
- [ ] T7C.3 å®ç° API Key é…ç½®åŠŸèƒ½
- [ ] T7C.4 å¼€å‘ CleaningRuleList ç»„ä»¶
- [ ] T7C.5 å¼€å‘ CleaningRuleForm ç»„ä»¶
- [ ] T7C.6 å®ç°è§„åˆ™ CRUD åŠŸèƒ½
- [ ] T7C.7 å¼€å‘ AlertRuleList ç»„ä»¶
- [ ] T7C.8 å¼€å‘ AlertRuleForm ç»„ä»¶
- [ ] T7C.9 å®ç°é¢„è­¦è§„åˆ™ CRUD åŠŸèƒ½

**æäº¤ç‚¹**: å®Œæˆç³»ç»Ÿé…ç½®æ¨¡å—

#### é˜¶æ®µ 7D: å¤§å±ç®¡ç†æ¨¡å—ï¼ˆä¾èµ–é˜¶æ®µ3ï¼Œå¯å¹¶è¡Œï¼‰
- [ ] T7D.1 å¼€å‘ ScreenPageList ç»„ä»¶
- [ ] T7D.2 å®ç°é¡µé¢åˆ—è¡¨å±•ç¤º
- [ ] T7D.3 å®ç°é¡µé¢é¢„è§ˆåŠŸèƒ½ï¼ˆè·³è½¬åˆ° web åº”ç”¨ï¼‰
- [ ] T7D.4 å®ç°é¡µé¢åˆ é™¤åŠŸèƒ½

**æäº¤ç‚¹**: å®Œæˆå¤§å±ç®¡ç†æ¨¡å—

#### é˜¶æ®µ 8: å…±äº«ç»„ä»¶å¼€å‘ï¼ˆä¾èµ–é˜¶æ®µ3ï¼Œå¯ä¸é˜¶æ®µ7å¹¶è¡Œï¼‰
- [ ] T8.1 å¼€å‘ SearchForm ç»„ä»¶
- [ ] T8.2 å¼€å‘ ConfirmModal ç»„ä»¶
- [ ] T8.3 å¼€å‘ StatusBadge ç»„ä»¶
- [ ] T8.4 å¼€å‘é€šç”¨ Pipes
- [ ] T8.5 å¼€å‘é€šç”¨ Directives

**æäº¤ç‚¹**: å®Œæˆå…±äº«ç»„ä»¶

#### é˜¶æ®µ 9: ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆä¾èµ–æ‰€æœ‰é˜¶æ®µï¼‰
- [ ] T9.1 æ€§èƒ½ä¼˜åŒ–ï¼ˆOnPush ç­–ç•¥ï¼‰
- [ ] T9.2 ä»£ç é‡æ„å’Œä¼˜åŒ–
- [ ] T9.3 å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰
- [ ] T9.4 E2E æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
- [ ] T9.5 å“åº”é€Ÿåº¦ä¼˜åŒ–
- [ ] T9.6 æ„å»ºä¼˜åŒ–å’Œæ‰“åŒ…

**æäº¤ç‚¹**: å®Œæˆæµ‹è¯•ä¼˜åŒ–

### æ‰§è¡Œé¡ºåºæ€»ç»“

#### ç¬¬ä¸€æœŸï¼ˆå¾®åš Cookie ç®¡ç†ï¼‰ğŸ¯
```
é˜¶æ®µ1ï¼ˆé¡¹ç›®åˆå§‹åŒ–ï¼‰ â†’ é˜¶æ®µ2ï¼ˆæ ¸å¿ƒæœåŠ¡ï¼‰ â†’ é˜¶æ®µ3ï¼ˆå¸ƒå±€+ç™»å½•ï¼‰ â†’
é˜¶æ®µ4ï¼ˆå¾®åš Cookie ç®¡ç†é¡µé¢ï¼‰
  âˆ¥
é˜¶æ®µ5ï¼ˆåç«¯ API å¼€å‘ï¼Œå¹¶è¡Œï¼‰
```

**ç¬¬ä¸€æœŸå®Œæˆæ ‡å¿—**:
- âœ… ç®¡ç†å‘˜å¯ä»¥ç™»å½•åå°
- âœ… å¯ä»¥é€šè¿‡æ‰«ç è·å–å¾®åš Cookie
- âœ… Cookie è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“
- âœ… å¯ä»¥æŸ¥çœ‹å’ŒéªŒè¯ Cookie çŠ¶æ€

#### ç¬¬äºŒæœŸï¼ˆå…¶ä»–åŠŸèƒ½ï¼‰
```
é˜¶æ®µ6ï¼ˆç³»ç»Ÿç›‘æ§ï¼‰ | é˜¶æ®µ7Aï¼ˆçˆ¬è™«ç®¡ç†ï¼‰ | é˜¶æ®µ7Bï¼ˆæ•°æ®ç®¡ç†ï¼‰ |
é˜¶æ®µ7Cï¼ˆç³»ç»Ÿé…ç½®ï¼‰ | é˜¶æ®µ7Dï¼ˆå¤§å±ç®¡ç†ï¼‰ | é˜¶æ®µ8ï¼ˆå…±äº«ç»„ä»¶ï¼‰
  â†“
é˜¶æ®µ9ï¼ˆä¼˜åŒ–ä¸æµ‹è¯•ï¼‰
```

**æ³¨æ„**:
- ç¬¬ä¸€æœŸä¸“æ³¨äºå¾®åš Cookie è·å–åŠŸèƒ½ï¼Œè¿™æ˜¯åç»­æ‰€æœ‰çˆ¬è™«ä»»åŠ¡çš„åŸºç¡€
- ç¬¬äºŒæœŸåŠŸèƒ½å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ä¼˜å…ˆçº§

## ä¾èµ–å®‰è£…

### NPM åŒ…
```bash
# NG-ZORRO
pnpm add ng-zorro-antd

# å›¾è¡¨åº“ï¼ˆç³»ç»Ÿç›‘æ§é¡µé¢ï¼Œç¬¬äºŒæœŸï¼‰
pnpm add ngx-echarts echarts

# æ—¥æœŸå¤„ç†
pnpm add date-fns

# Excel å¯¼å‡ºï¼ˆå¯é€‰ï¼Œä¹Ÿå¯åç«¯å®ç°ï¼Œç¬¬äºŒæœŸï¼‰
pnpm add xlsx
pnpm add @types/xlsx -D

# å·¥å…·åº“
pnpm add lodash-es
pnpm add @types/lodash-es -D

# JWT è§£ç ï¼ˆå¯é€‰ï¼Œç”¨äºè§£æ JWT Tokenï¼‰
pnpm add jwt-decode
```

### åç«¯ä¾èµ–ï¼ˆapps/apiï¼‰
```bash
# JWT é‰´æƒ
pnpm add @nestjs/jwt @nestjs/passport passport passport-jwt
pnpm add @types/passport-jwt -D

# å¯†ç åŠ å¯†
pnpm add bcrypt
pnpm add @types/bcrypt -D

# Playwrightï¼ˆå¾®åšæ‰«ç ç™»å½•ï¼‰
pnpm add playwright
npx playwright install chromium
```

### angular.json é…ç½®
```json
{
  "styles": [
    "node_modules/ng-zorro-antd/ng-zorro-antd.min.css",
    "src/styles.scss"
  ]
}
```

## é‰´æƒæ–¹æ¡ˆï¼ˆåŸºäºç”¨æˆ·è¡¨ + JWTï¼‰

### å®ç°æ–¹å¼
```typescript
// auth.service.ts
@Injectable({ providedIn: 'root' })
export class AuthService {
  private readonly TOKEN_KEY = 'admin_token';
  private readonly USER_KEY = 'admin_user';

  constructor(private http: HttpClient) {}

  // ç™»å½•
  login(username: string, password: string): Observable<LoginResponse> {
    return this.http.post<LoginResponse>('/api/admin/auth/login', {
      username,
      password
    }).pipe(
      tap(response => {
        if (response.success) {
          localStorage.setItem(this.TOKEN_KEY, response.token);
          localStorage.setItem(this.USER_KEY, JSON.stringify(response.user));
        }
      })
    );
  }

  // ç™»å‡º
  logout(): void {
    localStorage.removeItem(this.TOKEN_KEY);
    localStorage.removeItem(this.USER_KEY);
  }

  // æ˜¯å¦å·²ç™»å½•
  isAuthenticated(): boolean {
    return !!this.getToken();
  }

  // è·å– Token
  getToken(): string | null {
    return localStorage.getItem(this.TOKEN_KEY);
  }

  // è·å–å½“å‰ç”¨æˆ·
  getCurrentUser(): AdminUser | null {
    const userStr = localStorage.getItem(this.USER_KEY);
    return userStr ? JSON.parse(userStr) : null;
  }

  // ä¿®æ”¹å¯†ç 
  changePassword(oldPassword: string, newPassword: string): Observable<any> {
    return this.http.post('/api/admin/auth/change-password', {
      oldPassword,
      newPassword
    });
  }
}
```

### HTTP æ‹¦æˆªå™¨ï¼ˆæ·»åŠ  JWT Tokenï¼‰
```typescript
// auth.interceptor.ts
export const authInterceptor: HttpInterceptorFn = (req, next) => {
  const authService = inject(AuthService);
  const token = authService.getToken();

  if (token) {
    req = req.clone({
      setHeaders: {
        Authorization: `Bearer ${token}`
      }
    });
  }

  return next(req);
};
```

### è·¯ç”±å®ˆå«
```typescript
// auth.guard.ts
export const authGuard: CanActivateFn = (route, state) => {
  const authService = inject(AuthService);
  const router = inject(Router);

  if (authService.isAuthenticated()) {
    return true;
  }

  router.navigate(['/login'], { queryParams: { returnUrl: state.url } });
  return false;
};
```

### ç™»å½•ç»„ä»¶ç¤ºä¾‹
```typescript
// login.component.ts
@Component({
  selector: 'app-login',
  templateUrl: './login.component.html'
})
export class LoginComponent {
  loginForm = new FormGroup({
    username: new FormControl('', [Validators.required]),
    password: new FormControl('', [Validators.required])
  });

  constructor(
    private authService: AuthService,
    private router: Router,
    private message: NzMessageService
  ) {}

  onSubmit(): void {
    if (this.loginForm.valid) {
      const { username, password } = this.loginForm.value;
      this.authService.login(username!, password!).subscribe({
        next: (response) => {
          if (response.success) {
            this.message.success('ç™»å½•æˆåŠŸ');
            this.router.navigate(['/dashboard']);
          } else {
            this.message.error('ç™»å½•å¤±è´¥');
          }
        },
        error: (err) => {
          this.message.error('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯');
        }
      });
    }
  }
}
```

## UI è®¾è®¡é£æ ¼

### é…è‰²æ–¹æ¡ˆ
- ä¸»è‰²: Ant Design é»˜è®¤è“è‰² (#1890ff)
- æˆåŠŸ: #52c41a
- è­¦å‘Š: #faad14
- å±é™©: #f5222d
- ä¿¡æ¯: #1890ff

### å¸ƒå±€å°ºå¯¸
- ä¾§è¾¹æ å®½åº¦: 200pxï¼ˆå±•å¼€ï¼‰ï¼Œ80pxï¼ˆæŠ˜å ï¼‰
- é¡¶éƒ¨æ é«˜åº¦: 64px
- å†…å®¹åŒºåŸŸå†…è¾¹è·: 24px

### è¡¨æ ¼é…ç½®
- åˆ†é¡µå¤§å°: 10, 20, 50, 100
- é»˜è®¤åˆ†é¡µ: 20
- è¡¨æ ¼å°ºå¯¸: middle

## åç»­æ‰©å±•ï¼ˆå¯é€‰ï¼‰

### V2 ç‰ˆæœ¬åŠŸèƒ½
- [ ] å¤šç®¡ç†å‘˜è´¦å·æ”¯æŒ
- [ ] è§’è‰²æƒé™ç®¡ç†
- [ ] æ“ä½œæ—¥å¿—è®°å½•
- [ ] æ•°æ®ç»Ÿè®¡æŠ¥è¡¨
- [ ] å®šæ—¶ä»»åŠ¡ç®¡ç†
- [ ] ç³»ç»Ÿè®¾ç½®ï¼ˆSMTP é…ç½®ã€Webhook é…ç½®ç­‰ï¼‰
- [ ] æ•°æ®æ ‡æ³¨åŠŸèƒ½
- [ ] æƒ…æ„Ÿæ¨¡å‹è®­ç»ƒï¼ˆé›†æˆè‡ªå®šä¹‰æ¨¡å‹ï¼‰

---

*åˆ›å»ºæ—¶é—´: 2025-10-08*
*æœ€åæ›´æ–°: 2025-10-08*
