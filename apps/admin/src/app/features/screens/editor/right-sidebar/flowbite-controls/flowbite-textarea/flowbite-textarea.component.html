<div class="flowbite-textarea-wrapper">
  @if (label) {
    <label
      [for]="getTextareaId()"
      class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300"
      [class.text-red-600]="errorText"
    >
      {{ label }}
      @if (required) {
        <span class="text-red-500 ml-1">*</span>
      }
    </label>
  }

  <textarea
    [id]="getTextareaId()"
    [value]="value"
    [placeholder]="placeholder"
    [disabled]="disabled"
    [readonly]="readonly"
    [required]="required"
    [rows]="rows"
    [maxLength]="maxLength"
    [class]="textareaClasses"
    (input)="onValueChange($any($event.target).value)"
    (blur)="onBlur()"
    (focus)="onFocus()"
    (keydown)="onKeyDown($event)"
    (keyup)="onKeyUp($event)"
  ></textarea>

  @if (helperText && !errorText) {
    <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">{{ helperText }}</p>
  }

  @if (errorText) {
    <p class="mt-1 text-xs text-red-600 dark:text-red-400">{{ errorText }}</p>
  }

  @if (showCharCount && maxLength) {
    <p [class]="charCountClasses">
      {{ value?.length || 0 }} / {{ maxLength }}
      @if (isOverLimit) {
        <span class="ml-1">(超出 {{ remainingChars * -1 }} 字符)</span>
      }
    </p>
  }
</div>