<div class="accounts-container">
  <div class="accounts-header">
    <h2 class="accounts-title">京东账号管理</h2>
    <button
      (click)="showAddAccountDialog()"
      class="add-account-button"
      [disabled]="isLoading">
      添加账号
    </button>
  </div>

  <!-- 错误提示 -->
  <div *ngIf="error" class="error-alert">
    <svg class="error-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <p class="error-text">{{ error }}</p>
  </div>

  <!-- 加载状态 -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">加载中...</p>
  </div>

  <!-- 账号列表 -->
  <div *ngIf="!isLoading && accounts.length > 0" class="accounts-table-wrapper">
    <table class="accounts-table">
      <thead>
        <tr>
          <th>昵称</th>
          <th>PIN</th>
          <th>状态</th>
          <th>最后检查时间</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let account of accounts">
          <td class="account-nickname">{{ account.jdNickname || '-' }}</td>
          <td class="account-pin">{{ account.jdUid }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(account.status)">
              {{ getStatusText(account.status) }}
            </span>
          </td>
          <td class="account-date">{{ account.lastCheckAt ? formatDate(account.lastCheckAt) : '-' }}</td>
          <td class="account-actions">
            <button
              (click)="checkAccount(account)"
              [disabled]="isChecking(account.id)"
              class="action-button check-button"
              title="检查账号健康状态">
              <span *ngIf="isChecking(account.id)" class="button-spinner"></span>
              <span *ngIf="!isChecking(account.id)">检查</span>
            </button>
            <button
              (click)="deleteAccount(account)"
              [disabled]="isChecking(account.id)"
              class="action-button delete-button"
              title="删除账号">
              删除
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- 空状态 -->
  <div *ngIf="!isLoading && accounts.length === 0" class="empty-state">
    <svg class="empty-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
    </svg>
    <p class="empty-title">暂无京东账号</p>
    <p class="empty-description">点击"添加账号"按钮开始绑定您的京东账号</p>
  </div>

  <!-- 添加账号对话框 -->
  <div *ngIf="showLoginDialog" class="dialog-overlay" (click)="closeAddAccountDialog()">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      <button class="dialog-close" (click)="closeAddAccountDialog()" title="关闭">
        <svg class="close-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
      <app-jd-login></app-jd-login>
    </div>
  </div>
</div>
