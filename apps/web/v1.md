# 舆情大屏幕系统 V1 版本规划

## 概述
舆情大屏幕系统，用于实时展示舆情数据监控、分析和可视化，支持多维度数据展示和实时更新。

## 技术栈（已确认）
- 前端框架: React 18 + TypeScript
- 状态管理: Zustand
- 可视化库: ECharts
- 拖拽布局: react-grid-layout
- UI 组件库: Ant Design + 自定义大屏组件
- 构建工具: Vite
- 实时通信: WebSocket
- 数据请求: Axios
- CSS 方案: Tailwind CSS
- 动画库: framer-motion (可选)

## 组件拆分

### 1. 布局组件 (Layout Components)

#### 1.1 ScreenLayout (大屏主布局)
- 功能: 整体页面布局框架
- 包含: 头部、左中右三栏、底部
- 响应式适配: 支持不同分辨率大屏

#### 1.2 Header (顶部栏)
- 系统标题
- 当前时间显示
- 天气信息
- 系统状态指示器

#### 1.3 DataPanel (数据面板容器)
- 功能: 统一的数据卡片容器
- 支持标题、图标、边框动效
- 可配置大小和样式

### 2. 数据可视化组件 (Visualization Components)

#### 2.1 StatisticsCard (统计卡片)
- 显示关键指标数字
- 支持趋势箭头、百分比变化
- 动画数字滚动效果

#### 2.2 TrendChart (趋势图表)
- 折线图展示数据趋势
- 支持多条数据对比
- 时间轴切换 (小时/天/周/月)

#### 2.3 PieChart (饼图/环图)
- 舆情分类占比
- 情感分析分布
- 支持点击交互

#### 2.4 BarChart (柱状图)
- 热点话题 TOP N
- 媒体来源分布
- 地区分布排名

#### 2.5 MapChart (地图可视化)
- 地理位置热力图
- 区域舆情分布
- 支持省市级下钻

#### 2.6 WordCloud (词云图)
- 热词分布
- 关键词提取展示
- 支持点击过滤

#### 2.7 TimelineFlow (时间轴流)
- 舆情事件时间线
- 重大事件标注
- 支持滚动和缩放

#### 2.8 RankingList (排行榜)
- 热点事件排行
- 媒体活跃度排行
- 支持实时更新动画

### 3. 数据展示组件 (Data Display Components)

#### 3.1 NewsCard (新闻卡片)
- 单条舆情信息展示
- 包含标题、来源、时间、情感标签
- 支持点击查看详情

#### 3.2 ScrollList (滚动列表)
- 实时舆情流
- 自动滚动播放
- 支持暂停和手动滚动

#### 3.3 AlertPanel (预警面板)
- 负面舆情预警
- 敏感信息提示
- 分级预警展示

#### 3.4 SentimentMeter (情感仪表盘)
- 整体情感倾向
- 正面/中性/负面占比
- 仪表盘动画效果

### 4. 交互控制组件 (Control Components)

#### 4.1 FilterBar (筛选栏)
- 时间范围选择
- 数据源筛选
- 关键词搜索
- 情感类型过滤

#### 4.2 DateRangePicker (时间选择器)
- 快捷时间选择
- 自定义时间范围
- 适配大屏样式

#### 4.3 ScreenController (大屏控制器)
- 全屏切换
- 自动轮播控制
- 刷新频率设置
- 布局编辑模式切换

#### 4.4 LayoutEditor (布局编辑器) **【新增】**
- 拖拽式组件布局
- 组件尺寸调整
- 布局方案保存/加载
- 多屏幕预设模板
- 网格吸附功能

### 5. 装饰组件 (Decoration Components)

#### 5.1 BorderBox (边框装饰)
- 科技感边框
- 多种样式可选
- 支持动画效果

#### 5.2 BackgroundDecoration (背景装饰)
- 粒子背景
- 网格线
- 渐变背景

#### 5.3 LoadingAnimation (加载动画)
- 数据加载状态
- 大屏风格动画
- 骨架屏

## 项目结构
```
apps/web/
├── src/
│   ├── components/           # 组件目录
│   │   ├── layout/          # 布局组件
│   │   │   ├── ScreenLayout/
│   │   │   ├── Header/
│   │   │   └── DataPanel/
│   │   ├── visualization/   # 数据可视化组件
│   │   │   ├── StatisticsCard/
│   │   │   ├── TrendChart/
│   │   │   ├── PieChart/
│   │   │   ├── BarChart/
│   │   │   ├── MapChart/
│   │   │   ├── WordCloud/
│   │   │   ├── TimelineFlow/
│   │   │   └── RankingList/
│   │   ├── display/         # 数据展示组件
│   │   │   ├── NewsCard/
│   │   │   ├── ScrollList/
│   │   │   ├── AlertPanel/
│   │   │   └── SentimentMeter/
│   │   ├── control/         # 交互控制组件
│   │   │   ├── FilterBar/
│   │   │   ├── DateRangePicker/
│   │   │   ├── ScreenController/
│   │   │   └── LayoutEditor/
│   │   └── decoration/      # 装饰组件
│   │       ├── BorderBox/
│   │       ├── BackgroundDecoration/
│   │       └── LoadingAnimation/
│   ├── pages/               # 页面
│   │   └── Dashboard/       # 大屏主页面
│   ├── hooks/               # 自定义 Hooks
│   │   ├── useWebSocket.ts  # WebSocket 连接
│   │   ├── useRealTimeData.ts # 实时数据
│   │   └── useChartResize.ts  # 图表响应式
│   ├── services/            # API 服务
│   │   ├── api.ts           # API 封装
│   │   ├── websocket.ts     # WebSocket 服务
│   │   └── mock.ts          # Mock 数据
│   ├── store/               # 状态管理
│   │   ├── index.ts
│   │   └── slices/
│   ├── utils/               # 工具函数
│   │   ├── format.ts        # 数据格式化
│   │   ├── animation.ts     # 动画工具
│   │   └── chart.ts         # 图表配置
│   ├── types/               # TypeScript 类型定义
│   ├── constants/           # 常量配置
│   ├── styles/              # 样式文件
│   │   ├── global.css
│   │   ├── variables.css    # CSS 变量
│   │   └── theme/           # 主题配置
│   ├── assets/              # 静态资源
│   │   ├── images/
│   │   └── fonts/
│   ├── App.tsx
│   └── main.tsx
├── public/
├── package.json
├── vite.config.ts
└── tsconfig.json
```

## 开发计划（任务拆分与依赖关系）

### 阶段 1: 项目初始化（无依赖，可并行）
- [ ] T1.1 创建 Vite + React + TypeScript 项目
- [ ] T1.2 配置 pnpm workspace
- [ ] T1.3 安装基础依赖（React、TypeScript、Vite、Tailwind CSS）
- [ ] T1.4 安装核心依赖（Zustand、Axios、ECharts、react-grid-layout）
- [ ] T1.5 配置 ESLint + Prettier
- [ ] T1.6 配置 Tailwind CSS（大屏主题色配置）
- [ ] T1.7 创建基础目录结构

**提交点**: 完成基础项目配置

### 阶段 2: 基础设施搭建（依赖阶段1）
- [ ] T2.1 搭建状态管理（Zustand）
- [ ] T2.2 封装 Axios API 服务
- [ ] T2.3 实现 WebSocket 服务
- [ ] T2.4 创建 Mock 数据服务
- [ ] T2.5 定义 TypeScript 类型
- [ ] T2.6 实现自定义 Hooks (useWebSocket, useRealTimeData)
- [ ] T2.7 配置图表库（ECharts）

**提交点**: 完成基础设施搭建

### 阶段 3: 装饰组件开发（依赖阶段2，可并行）
- [ ] T3.1 开发 BorderBox 组件
- [ ] T3.2 开发 BackgroundDecoration 组件
- [ ] T3.3 开发 LoadingAnimation 组件

**提交点**: 完成装饰组件

### 阶段 4: 布局组件开发（依赖阶段2和3）
- [ ] T4.1 开发 DataPanel 容器组件
- [ ] T4.2 开发 Header 组件
- [ ] T4.3 开发 ScreenLayout 主布局

**提交点**: 完成布局框架

### 阶段 5A: 数据可视化组件开发（依赖阶段4，可并行）
- [ ] T5A.1 开发 StatisticsCard 组件
- [ ] T5A.2 开发 TrendChart 组件
- [ ] T5A.3 开发 PieChart 组件
- [ ] T5A.4 开发 BarChart 组件
- [ ] T5A.5 开发 MapChart 组件
- [ ] T5A.6 开发 WordCloud 组件
- [ ] T5A.7 开发 TimelineFlow 组件
- [ ] T5A.8 开发 RankingList 组件

**提交点**: 完成可视化组件

### 阶段 5B: 数据展示组件开发（依赖阶段4，可并行）
- [ ] T5B.1 开发 NewsCard 组件
- [ ] T5B.2 开发 ScrollList 组件
- [ ] T5B.3 开发 AlertPanel 组件
- [ ] T5B.4 开发 SentimentMeter 组件

**提交点**: 完成展示组件

### 阶段 5C: 交互控制组件开发（依赖阶段4，可并行）
- [ ] T5C.1 开发 FilterBar 组件
- [ ] T5C.2 开发 DateRangePicker 组件
- [ ] T5C.3 开发 ScreenController 组件
- [ ] T5C.4 开发 LayoutEditor 组件（集成 react-grid-layout）

**提交点**: 完成控制组件

### 阶段 6: 页面集成（依赖阶段5A、5B、5C完成）
- [ ] T6.1 实现默认布局配置（1920x1080、4K、超宽屏预设）
- [ ] T6.2 集成所有组件到 Dashboard 页面
- [ ] T6.3 实现数据流连接
- [ ] T6.4 实现 WebSocket 实时更新
- [ ] T6.5 实现布局编辑功能
- [ ] T6.6 实现布局配置持久化

**提交点**: 完成页面集成

### 阶段 7: 优化与测试（依赖阶段6）
- [ ] T7.1 性能优化（懒加载、虚拟滚动）
- [ ] T7.2 动画优化
- [ ] T7.3 单元测试
- [ ] T7.4 E2E 测试
- [ ] T7.5 浏览器兼容性测试
- [ ] T7.6 大屏适配测试（1920x1080, 4K等）

**提交点**: 完成测试优化

### 执行顺序总结
```
阶段1（并行） → 阶段2 → 阶段3（并行） → 阶段4 →
阶段5A、5B、5C（三者并行） → 阶段6 → 阶段7
```

## 需求确认
1. ✅ 不需要国际化支持
2. ✅ 使用 WebSocket 实时更新数据
3. ✅ 不需要主题切换（固定深色科技风格）
4. ✅ 支持超大屏幕自定义布局（1920x1080 / 4K / 超宽屏等）
5. ⏳ 后端 API 接口格式（待确认）
6. ⏳ 是否需要历史数据回放功能？
7. ⏳ 用户权限控制需求？
8. ⏳ 是否需要导出报告功能？

## 新增需求

### 自定义布局功能
基于超大屏幕需求，需要新增布局配置能力：

#### 新增组件：LayoutEditor (布局编辑器)
- 拖拽式组件布局
- 组件尺寸调整
- 布局方案保存/加载
- 多屏幕预设模板

#### 布局配置方案
```typescript
interface LayoutConfig {
  screenSize: '1920x1080' | '4K' | 'ultrawide' | 'custom';
  grid: {
    columns: number;
    rows: number;
  };
  widgets: Array<{
    id: string;
    component: string;
    position: { x: number; y: number };
    size: { w: number; h: number };
  }>;
}
```

#### 技术选型
- 使用 **react-grid-layout** 实现拖拽布局
- 布局配置存储到 localStorage 或后端

---
*创建时间: 2025-10-07*
