<div class="home-container">
  <!-- 标题栏 -->
  <header class="header" *ngIf="currentUser$ | async as user">
    <div class="header-content">
      <h1 class="title">数据大屏</h1>
      <div class="user-info">
        <span class="user-name">{{ user.username || user.id }}</span>
        <button class="logout-btn" (click)="logout()">退出登录</button>
      </div>
    </div>
  </header>

  <!-- 大屏展示区域 -->
  <main class="main-content">
    <div class="screen-container" [style.width.px]="screenConfig?.layout?.width" [style.height.px]="screenConfig?.layout?.height">
      @if (loading) {
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <p>加载中...</p>
        </div>
      } @else if (error) {
        <div class="error-container">
          <p class="error-message">{{ error }}</p>
        </div>
      } @else if (screenConfig) {
        <div class="screen-canvas" [style.background]="screenConfig.layout.background">
          <div class="components-container" #componentsContainer></div>
        </div>

        <!-- 控制面板 -->
        <div class="control-panel" [class.hidden]="isFullscreen">
          <div class="control-group">
            <button
              *ngIf="availableScreens.length > 1"
              class="control-button"
              (click)="toggleAutoPlay()"
              [title]="isAutoPlay ? '停止轮播' : '开始轮播'">
              {{ isAutoPlay ? '⏸️' : '▶️' }}
            </button>
            <button
              *ngIf="availableScreens.length > 1"
              class="control-button"
              (click)="previousScreen()"
              title="上一页">
              ⬅️
            </button>
            <button
              *ngIf="availableScreens.length > 1"
              class="control-button"
              (click)="nextScreen()"
              title="下一页">
              ➡️
            </button>
            <select
              *ngIf="availableScreens.length > 1"
              class="screen-selector"
              [value]="currentScreenIndex"
              (change)="switchToScreen($event)">
              <option *ngFor="let screen of availableScreens; let i = index" [value]="i">
                {{ screen.name }}
              </option>
            </select>
            <div *ngIf="availableScreens.length > 1" class="screen-indicator">
              {{ currentScreenIndex + 1 }} / {{ availableScreens.length }}
            </div>
          </div>
        </div>

        <button
          class="fullscreen-button"
          (click)="toggleFullscreen()"
          title="全屏切换">
          {{ isFullscreen ? '退出全屏' : '全屏显示' }}
        </button>
      }
    </div>
  </main>
</div>
