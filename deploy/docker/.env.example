# 基于MediaCrawler增强的微博爬取系统 - 环境变量配置示例
# Environment variables for Weibo Crawler System
# Copy this file to .env and update values

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL
POSTGRES_DB=pro
POSTGRES_USER=pro
POSTGRES_PASSWORD=your_secure_postgres_password

# MongoDB
MONGO_ROOT_USERNAME=admin
MONGO_ROOT_PASSWORD=your_secure_mongo_password
MONGO_DATABASE=pro

# Redis
REDIS_PASSWORD=your_secure_redis_password

# RabbitMQ
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=your_secure_rabbitmq_password
RABBITMQ_VHOST=/

# MinIO
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=your_secure_minio_password

# =============================================================================
# Crawler Configuration
# =============================================================================

# Performance settings
CRAWLER_CONCURRENCY=3
CRAWLER_DELAY_MIN=2000
CRAWLER_DELAY_MAX=5000
CRAWLER_MAX_RETRIES=3
CRAWLER_HEADLESS=true

# Anti-detection settings
ANTI_DETECTION_STEALTH_SCRIPT=true
ANTI_DETECTION_FINGERPRINTING=true
ANTI_DETECTION_UA_ROTATION=true
ANTI_DETECTION_TIMEZONE=Asia/Shanghai
ANTI_DETECTION_WEBGL=true
ANTI_DETECTION_CANVAS=true

# CDP Mode (advanced debugging)
CDP_ENABLED=false
CDP_DEBUG_PORT=9222
CDP_AUTO_CLOSE=true

# Rate monitoring
RATE_MONITORING_ENABLED=true
RATE_WINDOW_SIZE_MS=60000
RATE_MAX_REQUESTS_PER_WINDOW=10

# Adaptive delay
ADAPTIVE_DELAY_ENABLED=true
ADAPTIVE_DELAY_INCREASE_FACTOR=1.5
ADAPTIVE_DELAY_DECREASE_FACTOR=0.8
ADAPTIVE_DELAY_MAX_MS=30000
ADAPTIVE_DELAY_MIN_MS=1000

# =============================================================================
# Monitoring Configuration
# =============================================================================

# Grafana
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=your_secure_grafana_password

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# =============================================================================
# Security Configuration
# =============================================================================

# JWT secrets (if using authentication)
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRES_IN=24h

# WebSocket handshake safeguards
WS_HANDSHAKE_WINDOW_MS=10000
WS_MAX_HANDSHAKES_PER_IP=20
WS_HANDSHAKE_COOLDOWN_MS=15000
WS_FAILURE_WINDOW_MS=60000
WS_MAX_FAILURES_PER_IP=5
WS_FAILURE_COOLDOWN_MS=120000
WS_MAX_CONNECTIONS_PER_USER=8
WS_MAX_CONNECTIONS_PER_IP=12

# PubSub configuration
PUBSUB_DRIVER=redis
PUBSUB_NAMESPACE=@pro/api
PUBSUB_REDIS_MODE=standalone
PUBSUB_REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379
# 如需使用 Redis Cluster，请启用下列参数并提供节点列表
# PUBSUB_REDIS_CLUSTER_NODES=redis-cluster-0.redis:6379,redis-cluster-1.redis:6379
# PUBSUB_REDIS_PASSWORD=${REDIS_PASSWORD}
# PUBSUB_REDIS_TLS=false

# SSL/TLS
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem

# =============================================================================
# Weibo Account Configuration
# =============================================================================

# Add multiple Weibo accounts for rotation
WEIBO_ACCOUNTS_COUNT=3
WEIBO_ACCOUNT_1_COOKIE=cookie1_here
WEIBO_ACCOUNT_2_COOKIE=cookie2_here
WEIBO_ACCOUNT_3_COOKIE=cookie3_here

# =============================================================================
# Advanced Configuration
# =============================================================================

# Browser pool settings
BROWSER_POOL_SIZE=5
BROWSER_MAX_REUSE=100
BROWSER_IDLE_TIMEOUT=300000

# Proxy configuration (if using)
PROXY_ENABLED=false
PROXY_HOST=
PROXY_PORT=
PROXY_USERNAME=
PROXY_PASSWORD=

# Notification settings
NOTIFICATION_WEBHOOK_URL=
NOTIFICATION_EMAIL_SMTP_HOST=
NOTIFICATION_EMAIL_SMTP_PORT=587
NOTIFICATION_EMAIL_USERNAME=
NOTIFICATION_EMAIL_PASSWORD=
NOTIFICATION_EMAIL_TO=

# =============================================================================
# Development/Debug Configuration
# =============================================================================

# Debug mode (set to true in development)
DEBUG_MODE=false

# Additional logging
VERBOSE_LOGGING=false

# Performance profiling
PROFILING_ENABLED=false
